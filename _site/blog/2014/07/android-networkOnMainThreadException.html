<!DOCTYPE html>
<html lang="en">
  
  <head>
    <meta name="baidu-site-verification" content="HvuxptDcq6" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="从android.os.NetworkOnMainThreadException引发的思考 - Lippi-浮生志 - Lippi.OuYang(ouyanglip@gmail.com)">
    <title>
      从android.os.NetworkOnMainThreadException引发的思考 - Lippi-浮生志
    </title>
    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS 
    <link href="/css/blog.css" rel="stylesheet">-->
    <!-- index css -->
    <link href="/css/index.css" rel="stylesheet">
	<!-- pagments CSS-->
	<link href="/css/pygments.css" rel="stylesheet">
        <!-- jQuery Version 1.11.0 -->
    <script src="/js/jquery-1.11.0.js"> </script>
    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>
   <!-- 回到顶部js-->
    <script src="/js/index.js"></script>

	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?085fc257cb1e774f7764a2cf527c393d";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>

	<script>
    (function(){
     var bp = document.createElement('script');
	 bp.src = '//push.zhanzhang.baidu.com/push.js';
	 var s = document.getElementsByTagName("script")[0];
	 s.parentNode.insertBefore(bp, s);
	 })();
	</script>

  </head>
  
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">
              Toggle navigation
            </span>
            <span class="icon-bar">
            </span>
            <span class="icon-bar">
            </span>
            <span class="icon-bar">
            </span>
          </button>
          <a class="navbar-brand" href="/index.html">
            Lippi-浮生志
          </a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
            <li>
              <a href="/categories.html">
                分 类
              </a>
            </li>
            <li>
              <a href="/tags.html">
                标 签
              </a>
            </li>
            <li>
              <a href="/archives.html">
                归 档
              </a>
            </li>
            <li>
              <a href="/faqs.html">
                备 忘
              </a>
            </li>
            <li>
              <a href="/about.html">
                关 于
              </a>
            </li>
          </ul> 
        </div>
        <!-- /.navbar-collapse -->
      </div>
      <!-- /.container -->
    </nav>
    <!-- Page Content -->
    <div class="container">
      <div class="row">
        <!-- Blog Entries Column -->
        <div class="col-md-8">
          <!-- Blog Post -->
<!-- Title -->
<div class="row">
  <div class="post-area post">

 	<div class="post-list-body">
        	<div class="all-posts" post-cate="All">
 		<header>
		<h1>
		  从android.os.NetworkOnMainThreadException引发的思考
		  <div class="post-date"><a href="https://github.com/LippiOuYang/LippiOuYang.github.io/edit/master/_posts/2014-07-18-android-networkOnMainThreadException.md" target="_blank">纠错</a>&nbsp;&nbsp;
			<span class="glyphicon glyphicon-time"></span>
			18 Jul 2014
		  </div>
		</h1>
 		</header>
		<!-- Author -->
		<hr>
		 <article>
		<p>最近在写一个网络通信的程序，运行的时候抛出了这样一个异常，<code class="highlighter-rouge">android.os.NetworkOnMainThreadException</code>，找了很久没发现原因，后来查了下资料才知道是android的UI线程不能直接进行网络访问的操作。
##什么是UI线程？</p>

<blockquote>
  <p>The concept and importance of the application’s main <strong>UI thread</strong> is
something every Android developer should understand. Each time an
application is launched, the system creates a thread called “main” for
the application. The main thread (also known as the “UI thread”) is in
charge of dispatching events to the appropriate views/widgets and thus
is very important. It’s also the thread where your application
interacts with running components of your application’s UI. For
instance, if you touch a button on the screen, the UI thread
dispatches the touch event to the view, which then sets its pressed
state and posts an invalidate request to the event queue. The UI
thread dequeues this request and then tells the view to redraw itself.</p>

  <p>This single-thread model can yield poor performance unless Android
applications are implemented properly. Specifically, if the UI thread
was in charge of running everything in your entire application,
performing long operations such as network access or database queries
on the UI thread would block the entire user interface. No event would
be able to be dispatched—including drawing and touchscreen
events—while the long operation is underway. From the user’s
perspective, the application will appear to be frozen.</p>

  <p>In these situations, instant feedback is vital. Studies show that <strong>0.1</strong>
seconds is about the limit for having the user feel that the system is
reacting instantaneously. Anything slower than this limit will
probably be considered as <strong>lag</strong> (Miller 1968; Card et al. 1991). While a
fraction of a second might not seem harmful, even a tenth of a second
can be the difference between a good review and a bad review on Google
Play. Even worse, if the UI thread is blocked for more than about five
seconds, the user is presented with the notorious “application not
responding” (ANR) dialog and the app is force closed.</p>
</blockquote>

<hr />

<p>##为什么你的App Crashes？
The reason why your application crashes on Android versions 3.0 and above, but works fine on Android 2.x is because Honeycomb and Ice Cream Sandwich are much stricter about abuse against the UI Thread. For example, when an Android device running HoneyComb or above detects a network access on the UI thread, a NetworkOnMainThreadException will be thrown:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>E/AndroidRuntime(673): java.lang.RuntimeException: Unable to start activity
    ComponentInfo{com.example/com.example.ExampleActivity}:android.os.NetworkOnMainThreadException 在Android developer网站对NetworkOnMainThreadException是这样解释的：
</code></pre>
</div>

<blockquote>
  <p>A NetworkOnMainThreadException is thrown when an application attempts
to perform a networking operation on its main thread. This is only
thrown for applications targeting the Honeycomb SDK or higher.
Applications targeting earlier SDK versions are allowed to do
networking on their main event loop threads, but it’s heavily
discouraged.</p>
</blockquote>

<p><strong>安卓3.0以上不允许在UI线程执行以下操作：</strong></p>

<ol>
  <li>打开一个Socket连接(比如new Socket()).</li>
  <li>HTTP请求(比如HTTPClient and HTTPUrlConnection).</li>
  <li>尝试访问远程MySQL数据库.</li>
  <li>下载文件(Downloader.downloadFile()).</li>
</ol>

<p>If you are attempting to perform any of these operations on the UI thread, you must wrap them in a worker thread. The easiest way to do this is to use of an AsyncTask, which allows you to perform asynchronous work on your user interface. An AsyncTask will perform the blocking operations in a worker thread and will publish the results on the UI thread, without requiring you to handle threads and/or handlers yourself.</p>

<p>##Android AsyncTask完全解析
我们都知道，Android UI是线程不安全的，如果想要在子线程里进行UI操作，就需要借助Android的异步消息处理机制。</p>

<p>不过为了更加方便我们在子线程中更新UI元素，Android从1.5版本就引入了一个AsyncTask类，使用它就可以非常灵活方便地从子线程切换到UI线程，我们本篇文章的主角也就正是它了。</p>

<p>AsyncTask很早就出现在Android的API里了，所以我相信大多数朋友对它的用法都已经非常熟悉。不过今天我还是准备从AsyncTask的基本用法开始讲起，然后我们再来一起分析下AsyncTask源码，看看它是如何实现的，最后我会介绍一些关于AsyncTask你所不知道的秘密。</p>

<p>AsyncTask的基本用法
首先来看一下AsyncTask的基本用法，由于AsyncTask是一个抽象类，所以如果我们想使用它，就必须要创建一个子类去继承它。在继承时我们可以为AsyncTask类指定三个泛型参数，这三个参数的用途如下：</p>

<ul>
  <li>Params</li>
</ul>

<p>在执行AsyncTask时需要传入的参数，可用于在后台任务中使用。</p>

<ul>
  <li>Progress</li>
</ul>

<p>后台任务执行时，如果需要在界面上显示当前的进度，则使用这里指定的泛型作为进度单位。</p>

<ul>
  <li>Result</li>
</ul>

<p>当任务执行完毕后，如果需要对结果进行返回，则使用这里指定的泛型作为返回值类型。</p>

<p>因此，一个最简单的自定义AsyncTask就可以写成如下方式：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class DownloadTask extends AsyncTask&lt;Void, Integer, Boolean&gt; {  
    ……  
}  
</code></pre>
</div>

<p>这里我们把AsyncTask的第一个泛型参数指定为Void，表示在执行AsyncTask的时候不需要传入参数给后台任务。第二个泛型参数指定为Integer，表示使用整型数据来作为进度显示单位。第三个泛型参数指定为Boolean，则表示使用布尔型数据来反馈执行结果。
当然，目前我们自定义的DownloadTask还是一个空任务，并不能进行任何实际的操作，我们还需要去重写AsyncTask中的几个方法才能完成对任务的定制。经常需要去重写的方法有以下四个：</p>

<ul>
  <li>onPreExecute()</li>
</ul>

<p>这个方法会在后台任务开始执行之间调用，用于进行一些界面上的初始化操作，比如显示一个进度条对话框等。</p>

<ul>
  <li>doInBackground(Params…)</li>
</ul>

<p>这个方法中的所有代码都会在子线程中运行，我们应该在这里去处理所有的耗时任务。任务一旦完成就可以通过return语句来将任务的执行结果进行返回，如果AsyncTask的第三个泛型参数指定的是Void，就可以不返回任务执行结果。注意，在这个方法中是不可以进行UI操作的，如果需要更新UI元素，比如说反馈当前任务的执行进度，可以调用publishProgress(Progress…)方法来完成。</p>

<ul>
  <li>onProgressUpdate(Progress…)</li>
</ul>

<p>当在后台任务中调用了publishProgress(Progress…)方法后，这个方法就很快会被调用，方法中携带的参数就是在后台任务中传递过来的。在这个方法中可以对UI进行操作，利用参数中的数值就可以对界面元素进行相应的更新。</p>

<ul>
  <li>onPostExecute(Result)</li>
</ul>

<p>当后台任务执行完毕并通过return语句进行返回时，这个方法就很快会被调用。返回的数据会作为参数传递到此方法中，可以利用返回的数据来进行一些UI操作，比如说提醒任务执行的结果，以及关闭掉进度条对话框等。</p>

<p>因此，一个比较完整的自定义AsyncTask就可以写成如下方式：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class DownloadTask extends AsyncTask&lt;Void, Integer, Boolean&gt; {  
  
    @Override  
protected void onPreExecute() {  
    progressDialog.show();  
}  
  
@Override  
protected Boolean doInBackground(Void... params) {  
    try {  
        while (true) {  
            int downloadPercent = doDownload();  
            publishProgress(downloadPercent);  
            if (downloadPercent &gt;= 100) {  
                break;  
            }  
        }  
    } catch (Exception e) {  
        return false;  
    }  
    return true;  
}  
  
@Override  
protected void onProgressUpdate(Integer... values) {  
    progressDialog.setMessage("当前下载进度：" + values[0] + "%");  
}  
  
@Override  
protected void onPostExecute(Boolean result) {  
    progressDialog.dismiss();  
    if (result) {  
        Toast.makeText(context, "下载成功", Toast.LENGTH_SHORT).show();  
    } else {  
        Toast.makeText(context, "下载失败", Toast.LENGTH_SHORT).show();  
    }  
}   }   这里我们模拟了一个下载任务，在doInBackground()方法中去执行具体的下载逻辑，在onProgressUpdate()方法中显示当前的下载进度，在onPostExecute()方法中来提示任务的执行结果。如果想要启动这个任务，只需要简单地调用以下代码即可： [java] 

new DownloadTask().execute();  
</code></pre>
</div>

<p>以上就是AsyncTask的基本用法，怎么样，是不是感觉在子线程和UI线程之间进行切换变得灵活了很多？我们并不需求去考虑什么异步消息处理机制，也不需要专门使用一个Handler来发送和接收消息，只需要调用一下publishProgress()方法就可以轻松地从子线程切换到UI线程了。
分析AsyncTask的源码
虽然AsyncTask这么简单好用，但你知道它是怎样实现的吗？那么接下来，我们就来分析一下AsyncTask的源码，对它的实现原理一探究竟。注意这里我选用的是Android 4.0的源码，如果你查看的是其它版本的源码，可能会有一些出入。</p>

<p>从之前DownloadTask的代码就可以看出，在启动某一个任务之前，要先new出它的实例，因此，我们就先来看一看AsyncTask构造函数中的源码，如下所示：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public AsyncTask() {  
    mWorker = new WorkerRunnable&lt;Params, Result&gt;() {  
        public Result call() throws Exception {  
            mTaskInvoked.set(true);  
            Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);  
            return postResult(doInBackground(mParams));  
        }  
    };  
    mFuture = new FutureTask&lt;Result&gt;(mWorker) {  
        @Override  
        protected void done() {  
            try {  
                final Result result = get();  
                postResultIfNotInvoked(result);  
            } catch (InterruptedException e) {  
                android.util.Log.w(LOG_TAG, e);  
            } catch (ExecutionException e) {  
                throw new RuntimeException("An error occured while executing doInBackground()",  
                        e.getCause());  
            } catch (CancellationException e) {  
                postResultIfNotInvoked(null);  
            } catch (Throwable t) {  
                throw new RuntimeException("An error occured while executing "  
                        + "doInBackground()", t);  
            }  
        }  
    };  
}  
</code></pre>
</div>

<p>这段代码虽然看起来有点长，但实际上并没有任何具体的逻辑会得到执行，只是初始化了两个变量，mWorker和mFuture，并在初始化mFuture的时候将mWorker作为参数传入。mWorker是一个Callable对象，mFuture是一个FutureTask对象，这两个变量会暂时保存在内存中，稍后才会用到它们。
接着如果想要启动某一个任务，就需要调用该任务的execute()方法，因此现在我们来看一看execute()方法的源码，如下所示：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public final AsyncTask&lt;Params, Progress, Result&gt; execute(Params... params) {  
    return executeOnExecutor(sDefaultExecutor, params);  
}  
</code></pre>
</div>

<p>简单的有点过分了，只有一行代码，仅是调用了executeOnExecutor()方法，那么具体的逻辑就应该写在这个方法里了，快跟进去瞧一瞧：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public final AsyncTask&lt;Params, Progress, Result&gt; executeOnExecutor(Executor exec,  
        Params... params) {  
    if (mStatus != Status.PENDING) {  
        switch (mStatus) {  
            case RUNNING:  
                throw new IllegalStateException("Cannot execute task:"  
                        + " the task is already running.");  
            case FINISHED:  
                throw new IllegalStateException("Cannot execute task:"  
                        + " the task has already been executed "  
                        + "(a task can be executed only once)");  
        }  
    }  
    mStatus = Status.RUNNING;  
    onPreExecute();  
    mWorker.mParams = params;  
    exec.execute(mFuture);  
    return this;  
}  
</code></pre>
</div>

<p>果然，这里的代码看上去才正常点。可以看到，在第15行调用了onPreExecute()方法，因此证明了onPreExecute()方法会第一个得到执行。可是接下来的代码就看不明白了，怎么没见到哪里有调用doInBackground()方法呢？别着急，慢慢找总会找到的，我们看到，在第17行调用了Executor的execute()方法，并将前面初始化的mFuture对象传了进去，那么这个Executor对象又是什么呢？查看上面的execute()方法，原来是传入了一个sDefaultExecutor变量，接着找一下这个sDefaultExecutor变量是在哪里定义的，源码如下所示：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public static final Executor SERIAL_EXECUTOR = new SerialExecutor();  
……  
private static volatile Executor sDefaultExecutor = SERIAL_EXECUTOR;  
</code></pre>
</div>

<p>可以看到，这里先new出了一个SERIAL_EXECUTOR常量，然后将sDefaultExecutor的值赋值为这个常量，也就是说明，刚才在executeOnExecutor()方法中调用的execute()方法，其实也就是调用的SerialExecutor类中的execute()方法。那么我们自然要去看看SerialExecutor的源码了，如下所示：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>private static class SerialExecutor implements Executor {  
    final ArrayDeque&lt;Runnable&gt; mTasks = new ArrayDeque&lt;Runnable&gt;();  
    Runnable mActive;  
  
    public synchronized void execute(final Runnable r) {  
        mTasks.offer(new Runnable() {  
            public void run() {  
                try {  
                    r.run();  
                } finally {  
                    scheduleNext();  
                }  
            }  
        });  
        if (mActive == null) {  
            scheduleNext();  
        }  
    }  
  
    protected synchronized void scheduleNext() {  
        if ((mActive = mTasks.poll()) != null) {  
            THREAD_POOL_EXECUTOR.execute(mActive);  
        }  
    }  
}  
</code></pre>
</div>

<p>SerialExecutor类中也有一个execute()方法，这个方法里的所有逻辑就是在子线程中执行的了，注意这个方法有一个Runnable参数，那么目前这个参数的值是什么呢？当然就是mFuture对象了，也就是说在第9行我们要调用的是FutureTask类的run()方法，而在这个方法里又会去调用Sync内部类的innerRun()方法，因此我们直接来看innerRun()方法的源码：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>void innerRun() {  
    if (!compareAndSetState(READY, RUNNING))  
        return;  
    runner = Thread.currentThread();  
    if (getState() == RUNNING) { // recheck after setting thread  
        V result;  
        try {  
            result = callable.call();  
        } catch (Throwable ex) {  
            setException(ex);  
            return;  
        }  
        set(result);  
    } else {  
        releaseShared(0); // cancel  
    }  
} 
</code></pre>
</div>

<p>可以看到，在第8行调用了callable的call()方法，那么这个callable对象是什么呢？其实就是在初始化mFuture对象时传入的mWorker对象了，此时调用的call()方法，也就是一开始在AsyncTask的构造函数中指定的，我们把它单独拿出来看一下，代码如下所示：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public Result call() throws Exception {  
    mTaskInvoked.set(true);  
    Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);  
    return postResult(doInBackground(mParams));  
} 
</code></pre>
</div>

<p>在postResult()方法的参数里面，我们终于找到了doInBackground()方法的调用处，虽然经过了很多周转，但目前的代码仍然是运行在子线程当中的，所以这也就是为什么我们可以在doInBackground()方法中去处理耗时的逻辑。接着将doInBackground()方法返回的结果传递给了postResult()方法，这个方法的源码如下所示：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>private Result postResult(Result result) {  
    Message message = sHandler.obtainMessage(MESSAGE_POST_RESULT,  
            new AsyncTaskResult&lt;Result&gt;(this, result));  
    message.sendToTarget();  
    return result;  
} 
</code></pre>
</div>

<p>如果你已经熟悉了异步消息处理机制，这段代码对你来说一定非常简单吧。这里使用sHandler对象发出了一条消息，消息中携带了MESSAGE_POST_RESULT常量和一个表示任务执行结果的AsyncTaskResult对象。这个sHandler对象是InternalHandler类的一个实例，那么稍后这条消息肯定会在InternalHandler的handleMessage()方法中被处理。InternalHandler的源码如下所示：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>private static class InternalHandler extends Handler {  
    @SuppressWarnings({"unchecked", "RawUseOfParameterizedType"})  
    @Override  
    public void handleMessage(Message msg) {  
        AsyncTaskResult result = (AsyncTaskResult) msg.obj;  
        switch (msg.what) {  
            case MESSAGE_POST_RESULT:  
                // There is only one result  
                result.mTask.finish(result.mData[0]);  
                break;  
            case MESSAGE_POST_PROGRESS:  
                result.mTask.onProgressUpdate(result.mData);  
                break;  
        }  
    }  
}
</code></pre>
</div>

<p>这里对消息的类型进行了判断，如果这是一条MESSAGE_POST_RESULT消息，就会去执行finish()方法，如果这是一条MESSAGE_POST_PROGRESS消息，就会去执行onProgressUpdate()方法。那么finish()方法的源码如下所示：
[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>private void finish(Result result) {  
    if (isCancelled()) {  
        onCancelled(result);  
    } else {  
        onPostExecute(result);  
    }  
    mStatus = Status.FINISHED;  
}  
</code></pre>
</div>

<p>可以看到，如果当前任务被取消掉了，就会调用onCancelled()方法，如果没有被取消，则调用onPostExecute()方法，这样当前任务的执行就全部结束了。
我们注意到，在刚才InternalHandler的handleMessage()方法里，还有一种MESSAGE_POST_PROGRESS的消息类型，这种消息是用于当前进度的，调用的正是onProgressUpdate()方法，那么什么时候才会发出这样一条消息呢？相信你已经猜到了，查看publishProgress()方法的源码，如下所示：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>protected final void publishProgress(Progress... values) {  
    if (!isCancelled()) {  
        sHandler.obtainMessage(MESSAGE_POST_PROGRESS,  
                new AsyncTaskResult&lt;Progress&gt;(this, values)).sendToTarget();  
    }  
}
</code></pre>
</div>

<p>非常清晰了吧！正因如此，在doInBackground()方法中调用publishProgress()方法才可以从子线程切换到UI线程，从而完成对UI元素的更新操作。其实也没有什么神秘的，因为说到底，AsyncTask也是使用的异步消息处理机制，只是做了非常好的封装而已。
读到这里，相信你对AsyncTask中的每个回调方法的作用、原理、以及何时会被调用都已经搞明白了吧。</p>

<p><strong>关于AsyncTask你所不知道的秘密</strong>
不得不说，刚才我们在分析SerialExecutor的时候，其实并没有分析的很仔细，仅仅只是关注了它会调用mFuture中的run()方法，但是至于什么时候会调用我们并没有进一步地研究。其实SerialExecutor也是AsyncTask在3.0版本以后做了最主要的修改的地方，它在AsyncTask中是以常量的形式被使用的，因此在整个应用程序中的所有AsyncTask实例都会共用同一个SerialExecutor。下面我们就来对这个类进行更加详细的分析，为了方便阅读，我把它的代码再贴出来一遍：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>private static class SerialExecutor implements Executor {  
    final ArrayDeque&lt;Runnable&gt; mTasks = new ArrayDeque&lt;Runnable&gt;();  
    Runnable mActive;  
  
    public synchronized void execute(final Runnable r) {  
        mTasks.offer(new Runnable() {  
            public void run() {  
                try {  
                    r.run();  
                } finally {  
                    scheduleNext();  
                }  
            }  
        });  
        if (mActive == null) {  
            scheduleNext();  
        }  
    }  
  
    protected synchronized void scheduleNext() {  
        if ((mActive = mTasks.poll()) != null) {  
            THREAD_POOL_EXECUTOR.execute(mActive);  
        }  
    }  
} 
</code></pre>
</div>

<p>可以看到，SerialExecutor是使用ArrayDeque这个队列来管理Runnable对象的，如果我们一次性启动了很多个任务，首先在第一次运行execute()方法的时候，会调用ArrayDeque的offer()方法将传入的Runnable对象添加到队列的尾部，然后判断mActive对象是不是等于null，第一次运行当然是等于null了，于是会调用scheduleNext()方法。在这个方法中会从队列的头部取值，并赋值给mActive对象，然后调用THREAD_POOL_EXECUTOR去执行取出的取出的Runnable对象。之后如何又有新的任务被执行，同样还会调用offer()方法将传入的Runnable添加到队列的尾部，但是再去给mActive对象做非空检查的时候就会发现mActive对象已经不再是null了，于是就不会再调用scheduleNext()方法。
那么后面添加的任务岂不是永远得不到处理了？当然不是，看一看offer()方法里传入的Runnable匿名类，这里使用了一个try finally代码块，并在finally中调用了scheduleNext()方法，保证无论发生什么情况，这个方法都会被调用。也就是说，每次当一个任务执行完毕后，下一个任务才会得到执行，SerialExecutor模仿的是单一线程池的效果，如果我们快速地启动了很多任务，同一时刻只会有一个线程正在执行，其余的均处于等待状态。Android照片墙应用实现，再多的图片也不怕崩溃 这篇文章中例子的运行结果也证实了这个结论。</p>

<p>不过你可能还不知道，在Android 3.0之前是并没有SerialExecutor这个类的，那个时候是直接在AsyncTask中构建了一个sExecutor常量，并对线程池总大小，同一时刻能够运行的线程数做了规定，代码如下所示：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>private static final int CORE_POOL_SIZE = 5;  
private static final int MAXIMUM_POOL_SIZE = 128;  
private static final int KEEP_ALIVE = 10;  
……  
private static final ThreadPoolExecutor sExecutor = new ThreadPoolExecutor(CORE_POOL_SIZE,  
        MAXIMUM_POOL_SIZE, KEEP_ALIVE, TimeUnit.SECONDS, sWorkQueue, sThreadFactory);  
</code></pre>
</div>

<p>可以看到，这里规定同一时刻能够运行的线程数为5个，线程池总大小为128。也就是说当我们启动了10个任务时，只有5个任务能够立刻执行，另外的5个任务则需要等待，当有一个任务执行完毕后，第6个任务才会启动，以此类推。而线程池中最大能存放的线程数是128个，当我们尝试去添加第129个任务时，程序就会崩溃。
因此在3.0版本中AsyncTask的改动还是挺大的，在3.0之前的AsyncTask可以同时有5个任务在执行，而3.0之后的AsyncTask同时只能有1个任务在执行。为什么升级之后可以同时执行的任务数反而变少了呢？这是因为更新后的AsyncTask已变得更加灵活，如果不想使用默认的线程池，还可以自由地进行配置。比如使用如下的代码来启动任务：</p>

<p>[java]</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Executor exec = new ThreadPoolExecutor(15, 200, 10,  
        TimeUnit.SECONDS, new LinkedBlockingQueue&lt;Runnable&gt;());  
new DownloadTask().executeOnExecutor(exec); 
</code></pre>
</div>

<p>这样就可以使用我们自定义的一个Executor来执行任务，而不是使用SerialExecutor。上述代码的效果允许在同一时刻有15个任务正在执行，并且最多能够存储200个任务。
好了，到这里我们就已经把关于AsyncTask的所有重要内容深入浅出地理解了一遍，相信在将来使用它的时候能够更加得心应手。</p>

<p>参考：</p>

<ol>
  <li><a href="http://www.androiddesignpatterns.com/2012/06/app-force-close-honeycomb-ics.html">Why Ice Cream Sandwich Crashes your App</a></li>
  <li><a href="http://developer.android.com/reference/android/os/AsyncTask.html">AsyncTask</a></li>
  <li><a href="http://android-developers.blogspot.com/2010/07/multithreading-for-performance.html">Multithreading For Performance</a></li>
</ol>


		  </article>
		<hr>
	<br/>
        <p>
          本作品由 <a href="mailto:ouyanglip@gmail.com">Lippi.OuYang</a> 创作，采用
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="查看协议详细信息" target="_blank">CC BY-NC-SA 3.0 许可协议</a>
          进行许可。
        </p>
	<div style="margin-top:10px;margin-bottom:10px">
	  
	  <span class="next">
	    上篇：
	    <a href="/blog/2014/07/use-jekyll-build-blog-on-github.html">
	      使用jekyll在Github上搭建博客
	    </a>
	  </span>
	   
	  
	  <span class="prev">
	    下篇：
	    <a href="/blog/2014/07/android-UI-Thread.html">
	      Android UI线程和子线程、Service通信
	    </a>
	  </span>
	  
	</div>
	</div>
	
        
	<div post-cate="java">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/volley-source-code.html" class="post-list-item">
                    <h2>Volley源码分析</h2>
                    <span class="date">Aug 27, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/07/hibernate-cache-guide.html" class="post-list-item">
                    <h2>Hibernate缓存配置笔记</h2>
                    <span class="date">Jul 24, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/06/java-lambda-expression.html" class="post-list-item">
                    <h2>Java Lambda简明教程</h2>
                    <span class="date">Jun 3, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/04/java-virtual-mechine.html" class="post-list-item">
                    <h2>Java虚拟机简介</h2>
                    <span class="date">Apr 18, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/04/java-code-opt-one.html" class="post-list-item">
                    <h2>优化java代码建议(1)</h2>
                    <span class="date">Apr 12, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/02/cache.html" class="post-list-item">
                    <h2>谈谈缓存和基本的缓存算法</h2>
                    <span class="date">Feb 4, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/12/improve-webServer-performance.html" class="post-list-item">
                    <h2>谈谈如何提高web服务器并发性能</h2>
                    <span class="date">Dec 5, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/java-inner-class.html" class="post-list-item">
                    <h2>java中内部类</h2>
                    <span class="date">Nov 14, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/java-concurrent-collections.html" class="post-list-item">
                    <h2>java同步容器与并发容器</h2>
                    <span class="date">Nov 8, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/09/returning-null.html" class="post-list-item">
                    <h2>关于返回 Null 值的问题</h2>
                    <span class="date">Sep 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/why-jdk-string-is-final.html" class="post-list-item">
                    <h2>为什么 jdk 中把 String 类设计成 final</h2>
                    <span class="date">Aug 29, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/78-golden-rules-of-the-java-programming.html" class="post-list-item">
                    <h2>java编程的78条黄金法则</h2>
                    <span class="date">Aug 16, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/java-multithread.html" class="post-list-item">
                    <h2>java并发和多线程</h2>
                    <span class="date">Aug 2, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/android-UI-Thread.html" class="post-list-item">
                    <h2>Android UI线程和子线程、Service通信</h2>
                    <span class="date">Jul 19, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/android-networkOnMainThreadException.html" class="post-list-item">
                    <h2>从android.os.NetworkOnMainThreadException引发的思考</h2>
                    <span class="date">Jul 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/06/26-methods-to-improve-java-performance.html" class="post-list-item">
                    <h2>Java编程Tips</h2>
                    <span class="date">Jun 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/06/15/in-the-rain.html" class="post-list-item">
                    <h2>在雨中</h2>
                    <span class="date">Jun 14, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="c">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/12/c-code-opt.html" class="post-list-item">
                    <h2>C代码优化小贴士</h2>
                    <span class="date">Dec 27, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/libevent.html" class="post-list-item">
                    <h2>处理并发之二：libevent的eventbuffer</h2>
                    <span class="date">Aug 24, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/linux-epoll.html" class="post-list-item">
                    <h2>处理并发之一：LINUX Epoll机制介绍</h2>
                    <span class="date">Aug 23, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/c-advaced-programming.html" class="post-list-item">
                    <h2>C语言高级编程指南</h2>
                    <span class="date">Jul 5, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="programming">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/03/install-texlive-in-ubuntu.html" class="post-list-item">
                    <h2>在Ubuntu下安装和编译LaTex</h2>
                    <span class="date">Mar 15, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/github-pages-blog.html" class="post-list-item">
                    <h2>利用github-pages建立个人博客</h2>
                    <span class="date">Mar 1, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="post-list-item">
                    <h2>一个合格的程序员应该读过哪些书</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/c-advaced-programming.html" class="post-list-item">
                    <h2>C语言高级编程指南</h2>
                    <span class="date">Jul 5, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="jekyll">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/07/use-jekyll-build-blog-on-github.html" class="post-list-item">
                    <h2>使用jekyll在Github上搭建博客</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/markdown-syntax.html" class="post-list-item">
                    <h2>Markdown 语法 (简体中文版)</h2>
                    <span class="date">Jul 11, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/markdown-basics.html" class="post-list-item">
                    <h2>markdown 快速入门</h2>
                    <span class="date">Jul 10, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="other">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/03/vim-plugins.html" class="post-list-item">
                    <h2>一些强大的Vim插件</h2>
                    <span class="date">Mar 20, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/install-texlive-in-ubuntu.html" class="post-list-item">
                    <h2>在Ubuntu下安装和编译LaTex</h2>
                    <span class="date">Mar 15, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/github-pages-blog.html" class="post-list-item">
                    <h2>利用github-pages建立个人博客</h2>
                    <span class="date">Mar 1, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="post-list-item">
                    <h2>一个合格的程序员应该读过哪些书</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="reprints">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/09/returning-null.html" class="post-list-item">
                    <h2>关于返回 Null 值的问题</h2>
                    <span class="date">Sep 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/why-jdk-string-is-final.html" class="post-list-item">
                    <h2>为什么 jdk 中把 String 类设计成 final</h2>
                    <span class="date">Aug 29, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/78-golden-rules-of-the-java-programming.html" class="post-list-item">
                    <h2>java编程的78条黄金法则</h2>
                    <span class="date">Aug 16, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/use-jekyll-build-blog-on-github.html" class="post-list-item">
                    <h2>使用jekyll在Github上搭建博客</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="post-list-item">
                    <h2>一个合格的程序员应该读过哪些书</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Android">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/09/android-studio-plugins.html" class="post-list-item">
                    <h2>提高效率的Android Studio插件</h2>
                    <span class="date">Sep 9, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/android-opensource.html" class="post-list-item">
                    <h2>值得推荐的android开源框架</h2>
                    <span class="date">Oct 1, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="web">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/04/web-transmission-basis.html" class="post-list-item">
                    <h2>网络传输基础</h2>
                    <span class="date">Apr 16, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/web-server.html" class="post-list-item">
                    <h2>也谈如何构建高性能服务端程序</h2>
                    <span class="date">Nov 19, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/xmpp-analise.html" class="post-list-item">
                    <h2>XMPP协议分析-具体分析</h2>
                    <span class="date">Oct 31, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/androidDP-project.html" class="post-list-item">
                    <h2>Androidpn 消息推送总结</h2>
                    <span class="date">Oct 31, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/how-to-use-smack.html" class="post-list-item">
                    <h2>Smack开发手册</h2>
                    <span class="date">Oct 30, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/androidDP-introduction.html" class="post-list-item">
                    <h2>AndroidPN消息推送</h2>
                    <span class="date">Oct 30, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/xmpp.html" class="post-list-item">
                    <h2>XMPP协议分析-原理</h2>
                    <span class="date">Oct 28, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/jsp-jfreechart.html" class="post-list-item">
                    <h2>使用Jfreechart生成曲线显示到JSP中</h2>
                    <span class="date">Oct 22, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/how-http-works.html" class="post-list-item">
                    <h2>当我们打开网页时发生了什么</h2>
                    <span class="date">Oct 11, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="book">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/11/how-to-evaluate-the-hackers-and-painters.html" class="post-list-item">
                    <h2>如何评价『黑客与画家』</h2>
                    <span class="date">Nov 1, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="algorithm">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/12/skip-list.html" class="post-list-item">
                    <h2>skip list跳跃表实现</h2>
                    <span class="date">Dec 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/graph.html" class="post-list-item">
                    <h2>计算机算法--图算法介绍</h2>
                    <span class="date">Nov 29, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/leveldb.html" class="post-list-item">
                    <h2>leveldb原理剖析</h2>
                    <span class="date">Nov 18, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="c/c++">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/12/c-open-project.html" class="post-list-item">
                    <h2>值得推荐的C/C++框架和库</h2>
                    <span class="date">Dec 13, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="android">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/volley-source-code.html" class="post-list-item">
                    <h2>Volley源码分析</h2>
                    <span class="date">Aug 27, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/05/android-links.html" class="post-list-item">
                    <h2>安卓开发者必备的42个链接</h2>
                    <span class="date">May 19, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/05/define-custom-view.html" class="post-list-item">
                    <h2>Android自定义视图教程</h2>
                    <span class="date">May 17, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/android-studio-prefrence.html" class="post-list-item">
                    <h2>Android Studio多渠道打包和代码混淆教程</h2>
                    <span class="date">Mar 18, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Gradle">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/05/gradle-dependency-management.html" class="post-list-item">
                    <h2>Gradle系列教程之依赖管理</h2>
                    <span class="date">May 5, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/04/gradle-task-management.html" class="post-list-item">
                    <h2>Gradle系列教程之任务管理</h2>
                    <span class="date">Apr 30, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="lambda">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/06/java-lambda-expression.html" class="post-list-item">
                    <h2>Java Lambda简明教程</h2>
                    <span class="date">Jun 3, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="gradle">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/dagger-dependency-injection.html" class="post-list-item">
                    <h2>Dagger依赖注入浅析</h2>
                    <span class="date">Aug 13, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/07/gradle-tasks-guide.html" class="post-list-item">
                    <h2>彻底理解Gradle的任务</h2>
                    <span class="date">Jul 27, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Latex">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/latex-fonts-settings.html" class="post-list-item">
                    <h2>Latex中英文环境设置</h2>
                    <span class="date">Aug 22, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Unix/Linux">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2016/02/baidu-spider-forbidden.html" class="post-list-item">
                    <h2>解决百度爬虫无法抓取github pages</h2>
                    <span class="date">Feb 18, 2016</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2016/01/apache-configuration-in-ubuntu.html" class="post-list-item">
                    <h2>Ubuntu下Apache服务器的配置</h2>
                    <span class="date">Jan 20, 2016</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2016/01/tmux-guide.html" class="post-list-item">
                    <h2>终端复用软件之tmux简介</h2>
                    <span class="date">Jan 19, 2016</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/08/linux-zsh.html" class="post-list-item">
                    <h2>Zsh-Linux下最好的Shell简介</h2>
                    <span class="date">Aug 23, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Git">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2016/02/git-guide.html" class="post-list-item">
                    <h2>Git操作手册|命令速查表</h2>
                    <span class="date">Feb 20, 2016</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="hi">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2016/02/hi.html" class="post-list-item">
                    <h2>hi</h2>
                    <span class="date">Feb 22, 2016</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	 </div>

</div>


<!-- Blog Comments -->
<div class="media">
  <!-- UY BEGIN 
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2023801"></script>
UY END -->

<!-- 多说评论框 start -->
  <div class="post-comment">
            <span>Comments</span>
	<div class="ds-thread" data-thread-key="/blog/2014/07/android-networkOnMainThreadException" data-title="从android.os.NetworkOnMainThreadException引发的思考" data-url="LippiOuYang.github.io/blog/2014/07/android-networkOnMainThreadException.html">
	</div>
 </div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"lippiouyang"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
 
</div> 
</div>

        </div>

	 <div id="top" data-toggle="tooltip" data-placement="left" title="回到顶部">
	      <a href="javascript:;">
		<div class="arrow"></div>
		<div class="stick"></div>
	      </a>
	    </div>

        <!-- Blog Sidebar Widgets Column -->
        <div class="col-md-4">
          <!-- Blog Search Well -->  
	
                    <div class="shadow-corner-curl hidden-xs">
	  <div class="categories-list-header">站内搜索</div>
<!-- 使用该代码即表示您同意接受 Google 自定义搜索服务条款。 -->
<!-- 有关服务条款，请访问 http://www.google.com/cse/docs/tos.html?hl=zh-CN -->
<form name="cse" id="searchbox_demo" action="/search.html">
  <input type="hidden" name="cref" value="" />
  <input type="hidden" name="ie" value="utf-8" />
  <input type="hidden" name="hl" value="zh-CN" />
  <input name="q" type="text" size="30" />
  <input type="submit" name="sa" value="搜索" /> 
</form>
<script type="text/javascript" src="http://www.google.com/cse/tools/onthefly?form=searchbox_demo&lang=zh-CN"></script>			      
     
            
</div>








          <!-- Blog Categories Well -->
              

    <div class="shadow-corner-curl hidden-xs">
      <div class="categories-list-header">
        Categories
      </div>
      
      <a href="/index.html" class="categories-list-item" cate="All">
        All<span class="my-badge"> 61</span>
      </a>
      
        <a href="javascript:;" class="categories-list-item" cate="java">
          java <span class="my-badge">17</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="c">
          c <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="programming">
          programming <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="jekyll">
          jekyll <span class="my-badge">3</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="other">
          other <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="reprints">
          reprints <span class="my-badge">5</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Android">
          Android <span class="my-badge">2</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="web">
          web <span class="my-badge">9</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="book">
          book <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="algorithm">
          algorithm <span class="my-badge">3</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="c/c++">
          c/c++ <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="android">
          android <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Gradle">
          Gradle <span class="my-badge">2</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="lambda">
          lambda <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="gradle">
          gradle <span class="my-badge">2</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Latex">
          Latex <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Unix/Linux">
          Unix/Linux <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Git">
          Git <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="hi">
          hi <span class="my-badge">1</span>
        </a>
      
    </div>



 
         
              <div class="shadow-corner-curl hidden-xs">
      <div class="categories-list-header">
        热门文章
      </div>

 <ul class="list-unstyled">
      	<li><a href="/blog/2015/03/github-pages-blog.html" class="categories-list-item">利用Github-pages建立个人博客</a></li>	
<li><a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="categories-list-item">一个合格的程序员应该读过哪些书</a></li>
<li><a href="/blog/2014/12/c-open-project.html" class="categories-list-item">值得推荐的C/C++框架和库</a></li>
<li><a href="/blog/2014/12/c-code-opt.html" class="categories-list-item">C代码优化小贴士</a></li>	
<li><a href="/blog/2014/06/26-methods-to-improve-java-performance.html" class="categories-list-item">Java编程Tips</a></li>
<li><a href="/blog/2015/04/gradle-task-management.html" class="categories-list-item">Gradle系列教程之任务管理</a></li>	
<li><a href="/blog/2015/05/android-links.html" class="categories-list-item">安卓开发者必备的42个链接</a></li>
<li><a href="/blog/2015/05/gradle-dependency-management.html" class="categories-list-item">Gradle系列教程之依赖管理</a></li>
<li><a href="/blog/2014/10/android-opensource.html" class="categories-list-item">值得推荐的android开源框架</a></li>	 
<li><a href="/blog/2015/07/hibernate-cache-guide.html" class="categories-list-item">Hibernate缓存配置笔记</a></li>	
	 
     </ul>
</div>
 
       
                   <div class="shadow-corner-curl hidden-xs">
      <div class="categories-list-header">
        相关链接
      </div>    
 <ul class="list-unstyled">
              <li>
                <a href="https://github.com/" class="categories-list-item">
                   GitHub 
                </a>
              </li>
<li>
                <a href="http://www.stackoverflow.com/" class="categories-list-item">
                   Stack Overflow 
                </a>
              </li>
<li>
                <a href="http://jekyllrb.com/docs/posts/" class="categories-list-item">
                  Jekyll文档 
                </a>
              </li>
               
               <li>
                <a href="https://news.ycombinator.com/" class="categories-list-item">
                   Hacker News 
                </a>
              </li>        
              
              <li>
                <a href="http://developer.android.com/" class="categories-list-item">
                   Android Developer 
                </a>
              </li>
              
              <li>
                <a href="http://www.ruanyifeng.com/blog/" class="categories-list-item">
                   Ruanyifeng's Blog 
                </a>
              </li>


  <li>
                <a href="http://www.importnew.com/" class="categories-list-item">
                   ImportNew 
                </a>
              </li>
<li>
                <a href="http://guides.codepath.com/android" class="categories-list-item">
                   CodePath Android Cliffnotes 
                </a>
              </li>
<li>
                <a href="http://androidweekly.net/" class="categories-list-item">
                   Androidweekly 	
                </a>
              </li>
<li>
			<a href="http://mvnrepository.com/" class="categories-list-item">
                   Mvnrepository 
                </a>
              </li>
<li>
			<a href="http://www.iteye.com/" class="categories-list-item">
                  Iteye 
                </a>
              </li>
              		
            </ul>

</div>
 

          <!-- Side Widget Well -->
           
        </div>
      </div>



      <!-- /.row -->
      <hr>
      <!-- Footer -->
      <footer>
           <p><small>Designed by <a href="https://github.com/EZLippi">Lippi</a> | Free hosted at <a href="https://github.com/EZLippi/EZLippi.github.io">Github</a> | Copyright 2014 - 2016  
										</p>

	<!--
<div class="container">
    <div class="row">
      <div class="col-md-12">
        <a href="mailto:ouyanglip@gmail.com"><span class="glyphicon glyphicon-envelope"></span> ouyanglip@gmail.com</a>
        <span class="point"> · </span>
        
          
          <a href="https://github.com/LippiOuYang">
            <span class="icon">
              <svg viewBox="0 0 16 16">
                <path fill="#aaa" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            Github
          </a>
          
          
          <span class="point"> · </span>
          <span><a href="/feed.xml">RSS</a></span>
          <span class="point"> · </span>
          <span>Draw my life with code</span>
          <span class="point"> · </span>
          <span>&copy; 2014 LippiOuYang</span>
          <span class="point"> · </span>
          <span>Designed by <a href="https://github.com/LippiOuYang">Lippi</a></span>

      </div>
    </div>
    </div>
	-->
 
              <div style="display:none;"><script src="http://s95.cnzz.com/z_stat.php?id=1254799848&web_id=1254799848" language="JavaScript"></script></div>
 

      </footer>
    </div>
    <!-- /.container -->
  </body>

</html>
