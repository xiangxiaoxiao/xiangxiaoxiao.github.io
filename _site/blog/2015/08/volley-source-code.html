<!DOCTYPE html>
<html lang="en">
  
  <head>
    <meta name="baidu-site-verification" content="HvuxptDcq6" />
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Volley源码分析 - Lippi-浮生志 - Lippi.OuYang(ouyanglip@gmail.com)">
    <title>
      Volley源码分析 - Lippi-浮生志
    </title>
    <!-- Bootstrap Core CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS 
    <link href="/css/blog.css" rel="stylesheet">-->
    <!-- index css -->
    <link href="/css/index.css" rel="stylesheet">
	<!-- pagments CSS-->
	<link href="/css/pygments.css" rel="stylesheet">
        <!-- jQuery Version 1.11.0 -->
    <script src="/js/jquery-1.11.0.js"> </script>
    <!-- Bootstrap Core JavaScript -->
    <script src="/js/bootstrap.min.js"></script>
   <!-- 回到顶部js-->
    <script src="/js/index.js"></script>

	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?085fc257cb1e774f7764a2cf527c393d";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>

	<script>
    (function(){
     var bp = document.createElement('script');
	 bp.src = '//push.zhanzhang.baidu.com/push.js';
	 var s = document.getElementsByTagName("script")[0];
	 s.parentNode.insertBefore(bp, s);
	 })();
	</script>

  </head>
  
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">
              Toggle navigation
            </span>
            <span class="icon-bar">
            </span>
            <span class="icon-bar">
            </span>
            <span class="icon-bar">
            </span>
          </button>
          <a class="navbar-brand" href="/index.html">
            Lippi-浮生志
          </a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
            <li>
              <a href="/categories.html">
                分 类
              </a>
            </li>
            <li>
              <a href="/tags.html">
                标 签
              </a>
            </li>
            <li>
              <a href="/archives.html">
                归 档
              </a>
            </li>
            <li>
              <a href="/faqs.html">
                备 忘
              </a>
            </li>
            <li>
              <a href="/about.html">
                关 于
              </a>
            </li>
          </ul> 
        </div>
        <!-- /.navbar-collapse -->
      </div>
      <!-- /.container -->
    </nav>
    <!-- Page Content -->
    <div class="container">
      <div class="row">
        <!-- Blog Entries Column -->
        <div class="col-md-8">
          <!-- Blog Post -->
<!-- Title -->
<div class="row">
  <div class="post-area post">

 	<div class="post-list-body">
        	<div class="all-posts" post-cate="All">
 		<header>
		<h1>
		  Volley源码分析
		  <div class="post-date"><a href="https://github.com/LippiOuYang/LippiOuYang.github.io/edit/master/_posts/2015-08-27-volley-source-code.md" target="_blank">纠错</a>&nbsp;&nbsp;
			<span class="glyphicon glyphicon-time"></span>
			27 Aug 2015
		  </div>
		</h1>
 		</header>
		<!-- Author -->
		<hr>
		 <article>
		<p>说到Android的网络库，比较常用的就是Volley和okHttp了，最近重温了下Volley的源码，感觉应该写点什么．Volley 是 Google 推出的 Android 异步网络请求框架和图片加载框架，适合数据量小通信比较频繁的情形．</p>

<p>先看一下Volley的设计图：</p>

<p><img src="/images/volley.png" alt="" /></p>

<p>##请求Request</p>

<p>Volley里面每一个请求都是继承自Request抽象类，比如图中的StringRequest,JsonRequest,ImageRequest,请求最主要的几个属性有：http请求的方法method,请求资源url,是否应该缓存响应shouldCache,如果缓存的话就会有对应的缓存对象Cache.Entry,以及用来标识请求的序列号mSequence,当然这里的每一个请求是异步的，你还需要注册对应的响应监听器，<code class="highlighter-rouge">private final Listener&lt;String&gt; mListener;</code>,这个后面再讲．</p>

<p>##请求队列</p>

<p>请求队列是用来管理所有请求的，里面有四个集合类，如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="c1">//这个waitingRequest是因为用户可能重复提交了相同的请求，第一次提交一个请求后</span>
<span class="c1">//会在这个Map里添加一个key,表示这个请求已经在处理了，如果再提交相同的请求就会</span>
<span class="c1">//把这个请求添加到这个key对应的请求队列里，并把第一次的请求加入到缓存队列里，</span>
<span class="c1">//后面再发出这个请求就可以从缓存中获取响应了</span>
 <span class="kd">private</span> <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Queue</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;&gt;</span> <span class="n">mWaitingRequests</span> <span class="o">=</span>
		<span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Queue</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;&gt;();</span>
<span class="c1">//用来存储当前所有的请求</span>
<span class="kd">private</span> <span class="kd">final</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">mCurrentRequests</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashSet</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;();</span>
<span class="c1">//这是个优先队列，存储那些需要缓存的请求，处理这类请求时，先从缓存中查询，</span>
<span class="c1">//如果缓存miss再把它丢进networkRequest中从网络中获取数据  </span>
<span class="kd">private</span> <span class="kd">final</span> <span class="n">PriorityBlockingQueue</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">mCacheQueue</span> <span class="o">=</span>
		<span class="k">new</span> <span class="n">PriorityBlockingQueue</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;();</span>
<span class="c1">//这个队列用于存储需要直接从网络中获取数据的请求</span>
<span class="kd">private</span> <span class="kd">final</span> <span class="n">PriorityBlockingQueue</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">mNetworkQueue</span> <span class="o">=</span>
		<span class="k">new</span> <span class="n">PriorityBlockingQueue</span><span class="o">&lt;</span><span class="n">Request</span><span class="o">&lt;?&gt;&gt;();</span></code></pre></figure>

<p>上面讲到请求是保存在优先队列中，那么请求按照什么排序呢？自然是优先级了，
如果优先级一样就按照序列号排序，先进先出．请求一共有四个优先级，如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">enum</span> <span class="n">Priority</span> <span class="o">{</span>
        <span class="n">LOW</span><span class="o">,</span>
	<span class="n">NORMAL</span><span class="o">,</span>
	<span class="n">HIGH</span><span class="o">,</span>
	<span class="n">IMMEDIATE</span>
<span class="o">}</span></code></pre></figure>

<p>既然是这样那么请求一定实现了java的<code class="highlighter-rouge">Comparable</code>接口了，没错，而且正如前面所说请求按照优先级和序列号来排序，如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="o">(</span><span class="n">Request</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">other</span><span class="o">)</span> <span class="o">{</span>
<span class="n">Priority</span> <span class="n">left</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getPriority</span><span class="o">();</span>
<span class="n">Priority</span> <span class="n">right</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="na">getPriority</span><span class="o">();</span>

<span class="c1">// High-priority requests are "lesser" so they are sorted to the front.</span>
<span class="c1">// Equal priorities are sorted by sequence number to provide FIFO ordering.</span>
<span class="k">return</span> <span class="n">left</span> <span class="o">==</span> <span class="n">right</span> <span class="o">?</span>
        <span class="k">this</span><span class="o">.</span><span class="na">mSequence</span> <span class="o">-</span> <span class="n">other</span><span class="o">.</span><span class="na">mSequence</span> <span class="o">:</span>
        <span class="n">right</span><span class="o">.</span><span class="na">ordinal</span><span class="o">()</span> <span class="o">-</span> <span class="n">left</span><span class="o">.</span><span class="na">ordinal</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure>

<p>##请求分派RequestDispatcher</p>

<p>Volley里面有两个<code class="highlighter-rouge">Dispacher</code>,一个是<code class="highlighter-rouge">CacheDispatcher</code>,另一个是<code class="highlighter-rouge">NetworkDispatcher</code>,两个都是继承自线程，<code class="highlighter-rouge">CacheDispatcher</code>启动后从mCacheQueue里取出请求，根据请求的CacheKey(实际上是url)从缓存中检索数据，如果没有检索到数据就把它重新丢进<code class="highlighter-rouge">mNetworkQueue</code>中从网络中获取数据，如果缓存命中同时检查下缓存是否过期，如果缓存过期了照样要重新获取数据，否则调用<code class="highlighter-rouge">ResponseDelivery</code>把响应传递给相应的对象(实际上是调用请求注册的相应监听器)．
Volley默认启动了４个<code class="highlighter-rouge">NetworkDispatcher</code>线程来处理网络请求，为了避免过多的网络请求造成UI卡死，Volley默认把这些线程的优先级设置为后台线程<code class="highlighter-rouge">Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);</code></p>

<p>##HttpStack</p>

<p>Volley的<code class="highlighter-rouge">NetworkDispatcher</code>线程默认调用的是Network类的<code class="highlighter-rouge">HttpStack</code>的方法来执行Http请求，HttpStack的实现有两种，如果系统在 Gingerbread 及之后(即 API Level &gt;= 9)，采用基于 <code class="highlighter-rouge">HttpURLConnection</code> 的 HurlStack，如果小于 9，采用基于 HttpClient 的 <code class="highlighter-rouge">HttpClientStack</code>。</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="k">if</span> <span class="o">(</span><span class="n">stack</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">Build</span><span class="o">.</span><span class="na">VERSION</span><span class="o">.</span><span class="na">SDK_INT</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="o">)</span> <span class="o">{</span>
	<span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HurlStack</span><span class="o">();</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
	<span class="n">stack</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HttpClientStack</span><span class="o">(</span><span class="n">AndroidHttpClient</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">userAgent</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>得到了 HttpStack,然后通过它构造一个代表网络（Network）的具体实现BasicNetwork。</p>

<h3 id="httpurlconnection--androidhttpclienthttpclient">HttpURLConnection 和 AndroidHttpClient(HttpClient的封装)如何选择</h3>

<p>在 Froyo(2.2) 之前，HttpURLConnection 有个重大 Bug，调用 close() 函数会影响连接池，导致连接复用失效，所以在 Froyo 之前使用 HttpURLConnection 需要关闭 keepAlive。
另外在 Gingerbread(2.3) HttpURLConnection 默认开启了 gzip 压缩，提高了 HTTPS 的性能，Ice Cream Sandwich(4.0) HttpURLConnection 支持了请求结果缓存。
再加上 HttpURLConnection 本身 API 相对简单，所以对 Android 来说，在 2.3 之后建议使用 HttpURLConnection，之前建议使用 AndroidHttpClient。</p>

<h3 id="user-agent">关于 User Agent</h3>

<p>通过代码我们发现如果是使用 AndroidHttpClient，Volley 还会将请求头中的 User-Agent 字段设置为 App 的 ${packageName}/${versionCode}，如果异常则使用 “volley/0”，不过这个获取 User-Agent 的操作应该放到 if else 内部更合适。而对于 HttpURLConnection 却没有任何操作，为什么呢？
如果用 Fiddler 或 Charles 对数据抓包我们会发现，我们会发现 HttpURLConnection 默认是有 User-Agent 的，类似：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Dalvik/1.6.0 (Linux; U; Android 4.1.1; Google Nexus 4 - 4.1.1 - API 16 - 768x1280_1 Build/JRO03S)
</code></pre>
</div>

<p>经常用 WebView 的同学会也许会发现似曾相识，是的，WebView 默认的 User-Agent 也是这个。实际在请求发出之前，会检测 User-Agent 是否为空，如果不为空，则加上系统默认 User-Agent。在 Android 2.1 之后，我们可以通过</p>

<div class="highlighter-rouge"><pre class="highlight"><code>String userAgent = System.getProperty("http.agent");
</code></pre>
</div>

<p>得到系统默认的 User-Agent，Volley 如果希望自定义 User-Agent，可在自定义 Request 中重写 getHeaders() 函数</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="nf">getHeaders</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">AuthFailureError</span> <span class="o">{</span>
    <span class="c1">// self-defined user agent</span>
    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">headerMap</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;();</span>
    <span class="n">headerMap</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"User-Agent"</span><span class="o">,</span> <span class="s">"android-open-project-analysis/1.0"</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">headerMap</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<p>##DiskBasedCache</p>

<p>Volley默认是把缓存保存在文件中，并在内存中保存了缓存的头部，缓存头部占的最大内存可以设置，便于快速查询缓存是否存在．CacheHeader的主要属性有
文件大小size,缓存的etag,获取缓存的key,ttl,softTtl以及responseHeader.根据key来查询缓存，先从内存中查询是否存在CacheHeader,如果存在再从文件中把响应的data再读出来．每次向缓存中插入数据时先看看是否达到了缓存的最大大小，如果超过了容量就按照LRU算法从缓存中删除一部分数据直到满足需求，LRU算法实现很简单，直接调用LinkedHashMap来实现，<code class="highlighter-rouge">private final Map&lt;String, CacheHeader&gt; mEntries = new LinkedHashMap&lt;String, CacheHeader&gt;(16,0.75f,true)</code>.</p>

<p>##ByteArrayPool</p>

<p>ByteArrayPool很有意思，这是一个字节数组池，Volley进行网络操作的时候会把HTTP响应的内容写入到字节数组中，如果频繁的申请大的字节数组可能会对系统性能有所影响，所以Volley采取了对象池的方法来解决频繁申请内存的问题，它的实现也比较简单，用的两个字节数组链表，一个按照使用的先后排序，另一个按照字节数组的大小排序，如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span> <span class="n">mBuffersByLastUse</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinkedList</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;();</span>
<span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span> <span class="n">mBuffersBySize</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;(</span><span class="mi">64</span><span class="o">);</span></code></pre></figure>

<p>池当然也有它的大小限制．申请字节数组的时候从mBuffersBySize中申请一个比请求大小更大的数组给他，如果没找到就调用new从堆中申请一个字节数组返回给它，数组用完之后调用returnBuff返回给数组池中，当数组池的大小超过了规定的大小时，就按照LRU算法删除一些数组．那么这个对象池具体在哪里用上了呢？答案是在BasicNetwork中，调用HttpStack返回了Http响应，然后需要把响应的Entity转换为字节数组，一般我们会用ByteArrayOutputStream来做，但是ByteArrayOutputStream是需要从堆中申请一个字节数组的，所以Volley创建了一个继承自ByteArrayOutputStream的类PoolingByteArrayOutputStream并覆写了相应的方法．不得不佩服谷歌的工程师啊，每个细节都考虑的很周到．</p>

<h2 id="http">关于Http缓存</h2>

<p>Volley中对Http缓存作了相应的处理，在使用BasicNetwork执行Request之前，会给请求添加相应的缓存首部，利用<code class="highlighter-rouge">If-None-Match</code>和<code class="highlighter-rouge">If-Modified-Since</code>对过期缓存或者不新鲜缓存，进行请求再验证,代码如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">addCacheHeaders</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">headers</span><span class="o">,</span> <span class="n">Cache</span><span class="o">.</span><span class="na">Entry</span> <span class="n">entry</span><span class="o">)</span> <span class="o">{</span>
	<span class="c1">// If there's no cache entry, we're done.</span>
	<span class="k">if</span> <span class="o">(</span><span class="n">entry</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
	    <span class="k">return</span><span class="o">;</span>
	<span class="o">}</span>

	<span class="k">if</span> <span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">etag</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
	    <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"If-None-Match"</span><span class="o">,</span> <span class="n">entry</span><span class="o">.</span><span class="na">etag</span><span class="o">);</span>
	<span class="o">}</span>

	<span class="k">if</span> <span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">serverDate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
	    <span class="n">Date</span> <span class="n">refTime</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">serverDate</span><span class="o">);</span>
	    <span class="n">headers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"If-Modified-Since"</span><span class="o">,</span> <span class="n">DateUtils</span><span class="o">.</span><span class="na">formatDate</span><span class="o">(</span><span class="n">refTime</span><span class="o">));</span>
	<span class="o">}</span>
    <span class="o">}</span></code></pre></figure>

<p>同样，在收到Http响应之后，Volley也会检查响应首部中的缓存字段，根据<code class="highlighter-rouge">Cache-Control</code>和<code class="highlighter-rouge">Expires</code>首部来计算缓存的过期时间。如果两个首部都存在情况下，以<code class="highlighter-rouge">Cache-Control</code>为准。代码如下所示：</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">static</span> <span class="n">Cache</span><span class="o">.</span><span class="na">Entry</span> <span class="nf">parseCacheHeaders</span><span class="o">(</span><span class="n">NetworkResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span>
<span class="kt">long</span> <span class="n">now</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">();</span>

<span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">headers</span><span class="o">;</span>

<span class="kt">long</span> <span class="n">serverDate</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="kt">long</span> <span class="n">serverExpires</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="kt">long</span> <span class="n">softExpire</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="kt">long</span> <span class="n">maxAge</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
<span class="kt">boolean</span> <span class="n">hasCacheControl</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>

<span class="n">String</span> <span class="n">serverEtag</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
<span class="n">String</span> <span class="n">headerValue</span><span class="o">;</span>

<span class="n">headerValue</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"Date"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">headerValue</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">serverDate</span> <span class="o">=</span> <span class="n">parseDateAsEpoch</span><span class="o">(</span><span class="n">headerValue</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">headerValue</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"Cache-Control"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">headerValue</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">hasCacheControl</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="n">String</span><span class="o">[]</span> <span class="n">tokens</span> <span class="o">=</span> <span class="n">headerValue</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">","</span><span class="o">);</span>
    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">tokens</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">token</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">trim</span><span class="o">();</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">token</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"no-cache"</span><span class="o">)</span> <span class="o">||</span> <span class="n">token</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"no-store"</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">token</span><span class="o">.</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"max-age="</span><span class="o">))</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">maxAge</span> <span class="o">=</span> <span class="n">Long</span><span class="o">.</span><span class="na">parseLong</span><span class="o">(</span><span class="n">token</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="mi">8</span><span class="o">));</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">token</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"must-revalidate"</span><span class="o">)</span> <span class="o">||</span> <span class="n">token</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">"proxy-revalidate"</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">maxAge</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="n">headerValue</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"Expires"</span><span class="o">);</span>
<span class="k">if</span> <span class="o">(</span><span class="n">headerValue</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">serverExpires</span> <span class="o">=</span> <span class="n">parseDateAsEpoch</span><span class="o">(</span><span class="n">headerValue</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">serverEtag</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"ETag"</span><span class="o">);</span>

<span class="c1">// Cache-Control takes precedence over an Expires header, even if both exist and Expires</span>
<span class="c1">// is more restrictive.</span>
<span class="k">if</span> <span class="o">(</span><span class="n">hasCacheControl</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">softExpire</span> <span class="o">=</span> <span class="n">now</span> <span class="o">+</span> <span class="n">maxAge</span> <span class="o">*</span> <span class="mi">1000</span><span class="o">;</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">serverDate</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">serverExpires</span> <span class="o">&gt;=</span> <span class="n">serverDate</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Default semantic for Expire header in HTTP specification is softExpire.</span>
    <span class="n">softExpire</span> <span class="o">=</span> <span class="n">now</span> <span class="o">+</span> <span class="o">(</span><span class="n">serverExpires</span> <span class="o">-</span> <span class="n">serverDate</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">Cache</span><span class="o">.</span><span class="na">Entry</span> <span class="n">entry</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cache</span><span class="o">.</span><span class="na">Entry</span><span class="o">();</span>
<span class="n">entry</span><span class="o">.</span><span class="na">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">data</span><span class="o">;</span>
<span class="n">entry</span><span class="o">.</span><span class="na">etag</span> <span class="o">=</span> <span class="n">serverEtag</span><span class="o">;</span>
<span class="n">entry</span><span class="o">.</span><span class="na">softTtl</span> <span class="o">=</span> <span class="n">softExpire</span><span class="o">;</span>
<span class="n">entry</span><span class="o">.</span><span class="na">ttl</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="na">softTtl</span><span class="o">;</span>
<span class="n">entry</span><span class="o">.</span><span class="na">serverDate</span> <span class="o">=</span> <span class="n">serverDate</span><span class="o">;</span>
<span class="n">entry</span><span class="o">.</span><span class="na">responseHeaders</span> <span class="o">=</span> <span class="n">headers</span><span class="o">;</span>

<span class="k">return</span> <span class="n">entry</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<p>读完Volley的源码之后只有一个感觉，就是<code class="highlighter-rouge">谷歌出品，必属精品</code>.</p>

		  </article>
		<hr>
	<br/>
        <p>
          本作品由 <a href="mailto:ouyanglip@gmail.com">Lippi.OuYang</a> 创作，采用
          <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="查看协议详细信息" target="_blank">CC BY-NC-SA 3.0 许可协议</a>
          进行许可。
        </p>
	<div style="margin-top:10px;margin-bottom:10px">
	  
	  <span class="next">
	    上篇：
	    <a href="/blog/2015/08/linux-zsh.html">
	      Zsh-Linux下最好的Shell简介
	    </a>
	  </span>
	   
	  
	  <span class="prev">
	    下篇：
	    <a href="/blog/2015/09/android-studio-plugins.html">
	      提高效率的Android Studio插件
	    </a>
	  </span>
	  
	</div>
	</div>
	
        
	<div post-cate="java">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/volley-source-code.html" class="post-list-item">
                    <h2>Volley源码分析</h2>
                    <span class="date">Aug 27, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/07/hibernate-cache-guide.html" class="post-list-item">
                    <h2>Hibernate缓存配置笔记</h2>
                    <span class="date">Jul 24, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/06/java-lambda-expression.html" class="post-list-item">
                    <h2>Java Lambda简明教程</h2>
                    <span class="date">Jun 3, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/04/java-virtual-mechine.html" class="post-list-item">
                    <h2>Java虚拟机简介</h2>
                    <span class="date">Apr 18, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/04/java-code-opt-one.html" class="post-list-item">
                    <h2>优化java代码建议(1)</h2>
                    <span class="date">Apr 12, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/02/cache.html" class="post-list-item">
                    <h2>谈谈缓存和基本的缓存算法</h2>
                    <span class="date">Feb 4, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/12/improve-webServer-performance.html" class="post-list-item">
                    <h2>谈谈如何提高web服务器并发性能</h2>
                    <span class="date">Dec 5, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/java-inner-class.html" class="post-list-item">
                    <h2>java中内部类</h2>
                    <span class="date">Nov 14, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/java-concurrent-collections.html" class="post-list-item">
                    <h2>java同步容器与并发容器</h2>
                    <span class="date">Nov 8, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/09/returning-null.html" class="post-list-item">
                    <h2>关于返回 Null 值的问题</h2>
                    <span class="date">Sep 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/why-jdk-string-is-final.html" class="post-list-item">
                    <h2>为什么 jdk 中把 String 类设计成 final</h2>
                    <span class="date">Aug 29, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/78-golden-rules-of-the-java-programming.html" class="post-list-item">
                    <h2>java编程的78条黄金法则</h2>
                    <span class="date">Aug 16, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/java-multithread.html" class="post-list-item">
                    <h2>java并发和多线程</h2>
                    <span class="date">Aug 2, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/android-UI-Thread.html" class="post-list-item">
                    <h2>Android UI线程和子线程、Service通信</h2>
                    <span class="date">Jul 19, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/android-networkOnMainThreadException.html" class="post-list-item">
                    <h2>从android.os.NetworkOnMainThreadException引发的思考</h2>
                    <span class="date">Jul 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/06/26-methods-to-improve-java-performance.html" class="post-list-item">
                    <h2>Java编程Tips</h2>
                    <span class="date">Jun 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/06/15/in-the-rain.html" class="post-list-item">
                    <h2>在雨中</h2>
                    <span class="date">Jun 14, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="c">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/12/c-code-opt.html" class="post-list-item">
                    <h2>C代码优化小贴士</h2>
                    <span class="date">Dec 27, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/libevent.html" class="post-list-item">
                    <h2>处理并发之二：libevent的eventbuffer</h2>
                    <span class="date">Aug 24, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/linux-epoll.html" class="post-list-item">
                    <h2>处理并发之一：LINUX Epoll机制介绍</h2>
                    <span class="date">Aug 23, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/c-advaced-programming.html" class="post-list-item">
                    <h2>C语言高级编程指南</h2>
                    <span class="date">Jul 5, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="programming">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/03/install-texlive-in-ubuntu.html" class="post-list-item">
                    <h2>在Ubuntu下安装和编译LaTex</h2>
                    <span class="date">Mar 15, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/github-pages-blog.html" class="post-list-item">
                    <h2>利用github-pages建立个人博客</h2>
                    <span class="date">Mar 1, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="post-list-item">
                    <h2>一个合格的程序员应该读过哪些书</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/c-advaced-programming.html" class="post-list-item">
                    <h2>C语言高级编程指南</h2>
                    <span class="date">Jul 5, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="jekyll">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/07/use-jekyll-build-blog-on-github.html" class="post-list-item">
                    <h2>使用jekyll在Github上搭建博客</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/markdown-syntax.html" class="post-list-item">
                    <h2>Markdown 语法 (简体中文版)</h2>
                    <span class="date">Jul 11, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/markdown-basics.html" class="post-list-item">
                    <h2>markdown 快速入门</h2>
                    <span class="date">Jul 10, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="other">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/03/vim-plugins.html" class="post-list-item">
                    <h2>一些强大的Vim插件</h2>
                    <span class="date">Mar 20, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/install-texlive-in-ubuntu.html" class="post-list-item">
                    <h2>在Ubuntu下安装和编译LaTex</h2>
                    <span class="date">Mar 15, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/github-pages-blog.html" class="post-list-item">
                    <h2>利用github-pages建立个人博客</h2>
                    <span class="date">Mar 1, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="post-list-item">
                    <h2>一个合格的程序员应该读过哪些书</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="reprints">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/09/returning-null.html" class="post-list-item">
                    <h2>关于返回 Null 值的问题</h2>
                    <span class="date">Sep 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/why-jdk-string-is-final.html" class="post-list-item">
                    <h2>为什么 jdk 中把 String 类设计成 final</h2>
                    <span class="date">Aug 29, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/08/78-golden-rules-of-the-java-programming.html" class="post-list-item">
                    <h2>java编程的78条黄金法则</h2>
                    <span class="date">Aug 16, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/use-jekyll-build-blog-on-github.html" class="post-list-item">
                    <h2>使用jekyll在Github上搭建博客</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="post-list-item">
                    <h2>一个合格的程序员应该读过哪些书</h2>
                    <span class="date">Jul 15, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Android">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/09/android-studio-plugins.html" class="post-list-item">
                    <h2>提高效率的Android Studio插件</h2>
                    <span class="date">Sep 9, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/android-opensource.html" class="post-list-item">
                    <h2>值得推荐的android开源框架</h2>
                    <span class="date">Oct 1, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="web">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/04/web-transmission-basis.html" class="post-list-item">
                    <h2>网络传输基础</h2>
                    <span class="date">Apr 16, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/web-server.html" class="post-list-item">
                    <h2>也谈如何构建高性能服务端程序</h2>
                    <span class="date">Nov 19, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/xmpp-analise.html" class="post-list-item">
                    <h2>XMPP协议分析-具体分析</h2>
                    <span class="date">Oct 31, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/androidDP-project.html" class="post-list-item">
                    <h2>Androidpn 消息推送总结</h2>
                    <span class="date">Oct 31, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/how-to-use-smack.html" class="post-list-item">
                    <h2>Smack开发手册</h2>
                    <span class="date">Oct 30, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/androidDP-introduction.html" class="post-list-item">
                    <h2>AndroidPN消息推送</h2>
                    <span class="date">Oct 30, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/xmpp.html" class="post-list-item">
                    <h2>XMPP协议分析-原理</h2>
                    <span class="date">Oct 28, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/jsp-jfreechart.html" class="post-list-item">
                    <h2>使用Jfreechart生成曲线显示到JSP中</h2>
                    <span class="date">Oct 22, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/10/how-http-works.html" class="post-list-item">
                    <h2>当我们打开网页时发生了什么</h2>
                    <span class="date">Oct 11, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="book">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/11/how-to-evaluate-the-hackers-and-painters.html" class="post-list-item">
                    <h2>如何评价『黑客与画家』</h2>
                    <span class="date">Nov 1, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="algorithm">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/12/skip-list.html" class="post-list-item">
                    <h2>skip list跳跃表实现</h2>
                    <span class="date">Dec 18, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/graph.html" class="post-list-item">
                    <h2>计算机算法--图算法介绍</h2>
                    <span class="date">Nov 29, 2014</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2014/11/leveldb.html" class="post-list-item">
                    <h2>leveldb原理剖析</h2>
                    <span class="date">Nov 18, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="c/c++">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2014/12/c-open-project.html" class="post-list-item">
                    <h2>值得推荐的C/C++框架和库</h2>
                    <span class="date">Dec 13, 2014</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="android">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/volley-source-code.html" class="post-list-item">
                    <h2>Volley源码分析</h2>
                    <span class="date">Aug 27, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/05/android-links.html" class="post-list-item">
                    <h2>安卓开发者必备的42个链接</h2>
                    <span class="date">May 19, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/05/define-custom-view.html" class="post-list-item">
                    <h2>Android自定义视图教程</h2>
                    <span class="date">May 17, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/03/android-studio-prefrence.html" class="post-list-item">
                    <h2>Android Studio多渠道打包和代码混淆教程</h2>
                    <span class="date">Mar 18, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Gradle">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/05/gradle-dependency-management.html" class="post-list-item">
                    <h2>Gradle系列教程之依赖管理</h2>
                    <span class="date">May 5, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/04/gradle-task-management.html" class="post-list-item">
                    <h2>Gradle系列教程之任务管理</h2>
                    <span class="date">Apr 30, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="lambda">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/06/java-lambda-expression.html" class="post-list-item">
                    <h2>Java Lambda简明教程</h2>
                    <span class="date">Jun 3, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="gradle">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/dagger-dependency-injection.html" class="post-list-item">
                    <h2>Dagger依赖注入浅析</h2>
                    <span class="date">Aug 13, 2015</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/07/gradle-tasks-guide.html" class="post-list-item">
                    <h2>彻底理解Gradle的任务</h2>
                    <span class="date">Jul 27, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Latex">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2015/08/latex-fonts-settings.html" class="post-list-item">
                    <h2>Latex中英文环境设置</h2>
                    <span class="date">Aug 22, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Unix/Linux">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2016/02/baidu-spider-forbidden.html" class="post-list-item">
                    <h2>解决百度爬虫无法抓取github pages</h2>
                    <span class="date">Feb 18, 2016</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2016/01/apache-configuration-in-ubuntu.html" class="post-list-item">
                    <h2>Ubuntu下Apache服务器的配置</h2>
                    <span class="date">Jan 20, 2016</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2016/01/tmux-guide.html" class="post-list-item">
                    <h2>终端复用软件之tmux简介</h2>
                    <span class="date">Jan 19, 2016</span>
                  </a>
		</li>
                
              
                
		<li>
                  <a href="/blog/2015/08/linux-zsh.html" class="post-list-item">
                    <h2>Zsh-Linux下最好的Shell简介</h2>
                    <span class="date">Aug 23, 2015</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="Git">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2016/02/git-guide.html" class="post-list-item">
                    <h2>Git操作手册|命令速查表</h2>
                    <span class="date">Feb 20, 2016</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	<div post-cate="hi">
          <ul class="posts">
            
              
                
              
            
              
                
		<li>
                  <a href="/blog/2016/02/hi.html" class="post-list-item">
                    <h2>hi</h2>
                    <span class="date">Feb 22, 2016</span>
                  </a>
		</li>
                
              
            
          </ul>
	</div>
        
	 </div>

</div>


<!-- Blog Comments -->
<div class="media">
  <!-- UY BEGIN 
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2023801"></script>
UY END -->

<!-- 多说评论框 start -->
  <div class="post-comment">
            <span>Comments</span>
	<div class="ds-thread" data-thread-key="/blog/2015/08/volley-source-code" data-title="Volley源码分析" data-url="LippiOuYang.github.io/blog/2015/08/volley-source-code.html">
	</div>
 </div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"lippiouyang"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
 
</div> 
</div>

        </div>

	 <div id="top" data-toggle="tooltip" data-placement="left" title="回到顶部">
	      <a href="javascript:;">
		<div class="arrow"></div>
		<div class="stick"></div>
	      </a>
	    </div>

        <!-- Blog Sidebar Widgets Column -->
        <div class="col-md-4">
          <!-- Blog Search Well -->  
	
                    <div class="shadow-corner-curl hidden-xs">
	  <div class="categories-list-header">站内搜索</div>
<!-- 使用该代码即表示您同意接受 Google 自定义搜索服务条款。 -->
<!-- 有关服务条款，请访问 http://www.google.com/cse/docs/tos.html?hl=zh-CN -->
<form name="cse" id="searchbox_demo" action="/search.html">
  <input type="hidden" name="cref" value="" />
  <input type="hidden" name="ie" value="utf-8" />
  <input type="hidden" name="hl" value="zh-CN" />
  <input name="q" type="text" size="30" />
  <input type="submit" name="sa" value="搜索" /> 
</form>
<script type="text/javascript" src="http://www.google.com/cse/tools/onthefly?form=searchbox_demo&lang=zh-CN"></script>			      
     
            
</div>








          <!-- Blog Categories Well -->
              

    <div class="shadow-corner-curl hidden-xs">
      <div class="categories-list-header">
        Categories
      </div>
      
      <a href="/index.html" class="categories-list-item" cate="All">
        All<span class="my-badge"> 61</span>
      </a>
      
        <a href="javascript:;" class="categories-list-item" cate="java">
          java <span class="my-badge">17</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="c">
          c <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="programming">
          programming <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="jekyll">
          jekyll <span class="my-badge">3</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="other">
          other <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="reprints">
          reprints <span class="my-badge">5</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Android">
          Android <span class="my-badge">2</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="web">
          web <span class="my-badge">9</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="book">
          book <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="algorithm">
          algorithm <span class="my-badge">3</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="c/c++">
          c/c++ <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="android">
          android <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Gradle">
          Gradle <span class="my-badge">2</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="lambda">
          lambda <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="gradle">
          gradle <span class="my-badge">2</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Latex">
          Latex <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Unix/Linux">
          Unix/Linux <span class="my-badge">4</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="Git">
          Git <span class="my-badge">1</span>
        </a>
      
        <a href="javascript:;" class="categories-list-item" cate="hi">
          hi <span class="my-badge">1</span>
        </a>
      
    </div>



 
         
              <div class="shadow-corner-curl hidden-xs">
      <div class="categories-list-header">
        热门文章
      </div>

 <ul class="list-unstyled">
      	<li><a href="/blog/2015/03/github-pages-blog.html" class="categories-list-item">利用Github-pages建立个人博客</a></li>	
<li><a href="/blog/2014/07/qualified-programmer-should-read-what-books.html" class="categories-list-item">一个合格的程序员应该读过哪些书</a></li>
<li><a href="/blog/2014/12/c-open-project.html" class="categories-list-item">值得推荐的C/C++框架和库</a></li>
<li><a href="/blog/2014/12/c-code-opt.html" class="categories-list-item">C代码优化小贴士</a></li>	
<li><a href="/blog/2014/06/26-methods-to-improve-java-performance.html" class="categories-list-item">Java编程Tips</a></li>
<li><a href="/blog/2015/04/gradle-task-management.html" class="categories-list-item">Gradle系列教程之任务管理</a></li>	
<li><a href="/blog/2015/05/android-links.html" class="categories-list-item">安卓开发者必备的42个链接</a></li>
<li><a href="/blog/2015/05/gradle-dependency-management.html" class="categories-list-item">Gradle系列教程之依赖管理</a></li>
<li><a href="/blog/2014/10/android-opensource.html" class="categories-list-item">值得推荐的android开源框架</a></li>	 
<li><a href="/blog/2015/07/hibernate-cache-guide.html" class="categories-list-item">Hibernate缓存配置笔记</a></li>	
	 
     </ul>
</div>
 
       
                   <div class="shadow-corner-curl hidden-xs">
      <div class="categories-list-header">
        相关链接
      </div>    
 <ul class="list-unstyled">
              <li>
                <a href="https://github.com/" class="categories-list-item">
                   GitHub 
                </a>
              </li>
<li>
                <a href="http://www.stackoverflow.com/" class="categories-list-item">
                   Stack Overflow 
                </a>
              </li>
<li>
                <a href="http://jekyllrb.com/docs/posts/" class="categories-list-item">
                  Jekyll文档 
                </a>
              </li>
               
               <li>
                <a href="https://news.ycombinator.com/" class="categories-list-item">
                   Hacker News 
                </a>
              </li>        
              
              <li>
                <a href="http://developer.android.com/" class="categories-list-item">
                   Android Developer 
                </a>
              </li>
              
              <li>
                <a href="http://www.ruanyifeng.com/blog/" class="categories-list-item">
                   Ruanyifeng's Blog 
                </a>
              </li>


  <li>
                <a href="http://www.importnew.com/" class="categories-list-item">
                   ImportNew 
                </a>
              </li>
<li>
                <a href="http://guides.codepath.com/android" class="categories-list-item">
                   CodePath Android Cliffnotes 
                </a>
              </li>
<li>
                <a href="http://androidweekly.net/" class="categories-list-item">
                   Androidweekly 	
                </a>
              </li>
<li>
			<a href="http://mvnrepository.com/" class="categories-list-item">
                   Mvnrepository 
                </a>
              </li>
<li>
			<a href="http://www.iteye.com/" class="categories-list-item">
                  Iteye 
                </a>
              </li>
              		
            </ul>

</div>
 

          <!-- Side Widget Well -->
           
        </div>
      </div>



      <!-- /.row -->
      <hr>
      <!-- Footer -->
      <footer>
           <p><small>Designed by <a href="https://github.com/EZLippi">Lippi</a> | Free hosted at <a href="https://github.com/EZLippi/EZLippi.github.io">Github</a> | Copyright 2014 - 2016  
										</p>

	<!--
<div class="container">
    <div class="row">
      <div class="col-md-12">
        <a href="mailto:ouyanglip@gmail.com"><span class="glyphicon glyphicon-envelope"></span> ouyanglip@gmail.com</a>
        <span class="point"> · </span>
        
          
          <a href="https://github.com/LippiOuYang">
            <span class="icon">
              <svg viewBox="0 0 16 16">
                <path fill="#aaa" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            Github
          </a>
          
          
          <span class="point"> · </span>
          <span><a href="/feed.xml">RSS</a></span>
          <span class="point"> · </span>
          <span>Draw my life with code</span>
          <span class="point"> · </span>
          <span>&copy; 2014 LippiOuYang</span>
          <span class="point"> · </span>
          <span>Designed by <a href="https://github.com/LippiOuYang">Lippi</a></span>

      </div>
    </div>
    </div>
	-->
 
              <div style="display:none;"><script src="http://s95.cnzz.com/z_stat.php?id=1254799848&web_id=1254799848" language="JavaScript"></script></div>
 

      </footer>
    </div>
    <!-- /.container -->
  </body>

</html>
